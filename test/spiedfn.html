<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>SpiedFn Unit Tests</title>
  <link rel="import" href="../main.html">
  <script src="../node_modules/chai/chai.js"></script>
</head>
<body>
  <div id="qunit"></div>
  <div id="qunit-fixture"></div>
  <script>
    'use strict';

    var SpiedFn = System.get('src/spiedfn.es6').default;
    var expect = chai.expect;

    describe('SpiedFn', function() {
      var C = {};

      beforeEach(function(done) {
        C.fn = function() { return 1; };
        done();
      });

      describe('#restore', function() {
        it('should restore original function', function() {
          var spiedFn = new SpiedFn(C, 'fn');

          // Replace the function.
          C.fn = function() { return 2; };
          expect(C.fn()).to.equal(2);

          // Now restore the function.
          spiedFn.restore();
          expect(C.fn()).to.equal(1);
        });  
      });

      describe('#record', function() {
        it('should record the arguments', function() {
          var spiedFn = new SpiedFn(C, 'fn');
          var args1 = [1, 2, 3, 4];
          var args2 = [5, 6, 7];

          spiedFn.record(args1);
          spiedFn.record(args2);

          expect(spiedFn.records).to.deep.equal([args1, args2]);
        });
      });
    });
  </script>
</body>
</html>